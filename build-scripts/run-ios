XCODE_PROJECT_DIR="../ios"
OUTPUT_DIR="../output" #Output directory relative to XCODE_PROJECT_DIR

#variables
EXPORT_OPTIONS_PLIST_PATH="exportOptions.plist"
OUTPUT_ARCHIVE_PATH="$OUTPUT_DIR/webport.xcarchive"
OUTPUT_IPA_PATH="$OUTPUT_DIR/webport.ipa"
ARCHIVE_APP_PATH="$OUTPUT_DIR/webport.xcarchive/Products/Applications/webport.app"

#Verify that ios deploy is installed
if ! [ -x "$(command -v ios-deploy)" ]; then
    echo "Missing ios-deploy! Install it via: npm install -g ios-deploy"
    exit 1
fi

cd $XCODE_PROJECT_DIR

if [ -f $OUTPUT_ARCHIVE_PATH ]; then
    rm $OUTPUT_ARCHIVE_PATH
fi

#Build
xcodebuild -project ./webport.xcodeproj -scheme "webport" -configuration Debug archive -archivePath $OUTPUT_ARCHIVE_PATH

#Log into console weather the build was successful or not
if [ -d $OUTPUT_ARCHIVE_PATH ]; then
    echo "\nBuild SUCCESSFUL.\n"
else
    echo "\nBuild FAILED.\n"
    exit 1
fi

ios-deploy --debug --bundle $ARCHIVE_APP_PATH &